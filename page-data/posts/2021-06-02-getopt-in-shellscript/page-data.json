{"componentChunkName":"component---src-templates-post-js","path":"/posts/2021-06-02-getopt-in-shellscript/","result":{"data":{"site":{"siteMetadata":{"title":"MJUN Tech Note","author":"Junya Morioka"}},"markdownRemark":{"id":"2c71b230-8d7c-59bd-854d-915c36dd8531","html":"<p>こんにちは。今回もShellScript絡みです。<br>\n本稿ではShell Scriptでオプション引数を扱うgetoptについてメモします。<br>\nPythonだとargparseですね。</p>\n<h2 id=\"getoptとgetopts\">getoptとgetopts</h2>\n<p>Shell Scriptでオプション引数を扱うにはgetoptとgetoptsの2つの方法がある。<br>\ngetoptは外部コマンドでgetoptsはbash組み込みのコマンドです。<br>\ngetoptはBSD(macOS)とGNU(Linux)で挙動が異なるため、汎用性を考えたときにはgetoptsを使ったほうが良い。[[1][1]]</p>\n<h2 id=\"usage\">Usage</h2>\n<p>というわけで本稿ではgetoptsに絞ってオプション引数の扱い方を見ていきます。<br>\n早速ですが使い方は以下のようになります。[[2][2]]</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">while</span> <span class=\"token builtin class-name\">getopts</span> abc OPT\n<span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">case</span> <span class=\"token variable\">$OPT</span> <span class=\"token keyword\">in</span>\n     a<span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"use -a option\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n     b<span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"use -b option\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n     c<span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"use -c option\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">esac</span>\n<span class=\"token keyword\">done</span></code></pre></div>\n<p>上記のスクリプトの実行結果は以下です。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./a.sh\n\n./a.sh <span class=\"token parameter variable\">-a</span>\n<span class=\"token comment\"># use -a option</span>\n\n./a.sh <span class=\"token parameter variable\">-b</span>\n<span class=\"token comment\"># use -b option</span>\n\n./a.sh <span class=\"token parameter variable\">-d</span>\n<span class=\"token comment\">#./a.sh: illegal option -- d</span></code></pre></div>\n<p>上記のスクリプトですが、エラーメッセージを表示させない場合は</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">- <span class=\"token keyword\">while</span> <span class=\"token builtin class-name\">getopts</span> abc OPT\n\n+ <span class=\"token keyword\">while</span> <span class=\"token builtin class-name\">getopts</span> :abc OPT</code></pre></div>\n<p>に変更すればErrorメッセージが表示されません。</p>\n<p>オプションに追加して引数を受け入れる場合は以下のように、オプション文字の後に<code class=\"language-text\">:</code>を追加します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">while</span> <span class=\"token builtin class-name\">getopts</span> a: OPT\n<span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">case</span> <span class=\"token variable\">$OPT</span> <span class=\"token keyword\">in</span>\n     a<span class=\"token punctuation\">)</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"use -a option and input <span class=\"token variable\">$OPTARG</span>\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">esac</span>\n<span class=\"token keyword\">done</span></code></pre></div>\n<p>これを実行すると、</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./a.sh <span class=\"token parameter variable\">-a</span> aaa\n<span class=\"token comment\"># use -a option and input aaa</span></code></pre></div>\n<p>となります。</p>\n<h2 id=\"参考\">参考</h2>\n<h3 id=\"文献\">文献</h3>\n<p>[1]: <a href=\"https://takuya-1st.hatenablog.jp/entry/2015/12/24/234238\">https://takuya-1st.hatenablog.jp/entry/2015/12/24/234238</a><br>\n[1]:<a href=\"https://takuya-1st.hatenablog.jp/entry/2015/12/24/234238\">https://takuya-1st.hatenablog.jp/entry/2015/12/24/234238</a>\n[2]: <a href=\"https://www.atmarkit.co.jp/ait/articles/2002/13/news025.html\">https://www.atmarkit.co.jp/ait/articles/2002/13/news025.html</a><br>\n[2]:<a href=\"https://www.atmarkit.co.jp/ait/articles/2002/13/news025.html\">https://www.atmarkit.co.jp/ait/articles/2002/13/news025.html</a></p>","tableOfContents":"<ul>\n<li><a href=\"#getopt%E3%81%A8getopts\">getoptとgetopts</a></li>\n<li><a href=\"#usage\">Usage</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83\">参考</a></li>\n</ul>","excerpt":"こんにちは。今回もShellScript絡みです。 本稿ではShell Scriptでオプション引数を扱うgetoptについてメモします。 Pythonだとargparseですね。 getoptとgetopts Shell Scriptでオプション引数を扱うにはgetopt…","frontmatter":{"title":"Shell Scriptでオプション解析をする getopts","date":"2021.06.02","update":"2021.06.02","category":"shellscript","tags":["shellscript"]},"fields":{"slug":"/posts/2021-06-02-getopt-in-shellscript/"}}},"pageContext":{"id":"2c71b230-8d7c-59bd-854d-915c36dd8531"}},"staticQueryHashes":["1123391092"],"slicesMap":{}}