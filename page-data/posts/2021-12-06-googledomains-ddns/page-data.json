{"componentChunkName":"component---src-templates-post-js","path":"/posts/2021-12-06-googledomains-ddns/","result":{"data":{"site":{"siteMetadata":{"title":"MJUN Tech Note","author":"Junya Morioka"}},"markdownRemark":{"id":"ac8bba61-4f37-547a-89ff-3668d2554c21","html":"<p>今回は，Google Domains の DDNS を使ってドメインに動的に ip アドレスを振る方法を書く．</p>\n<h2 id=\"ddns-とは\">DDNS とは</h2>\n<p>DDNS は Dynamic DNS の略で，ドメインに割り当てられたホストの IP アドレスに変更があった場合に DNS サーバに通知を行って，ドメインの IP を変更するサービスのことである．</p>\n<p>通常の光回線契約では，HGW ルータの電源を入れ直す度に新しいグローバル IP が付与されることが多い．その場合，ドメインに紐づけられた IP を都度変更しなければならない．もちろん固定 IP の契約もできるが料金がかかるため，小規模な自宅サーバなら DDNS を利用したほうが低コストで常時自宅サーバにドメイン名でアクセスできる．</p>\n<h2 id=\"google-domains\">Google Domains</h2>\n<p>Google Domains では DDNS が利用でき，サーバ側で<code class=\"language-text\">ddclient</code>を使えば簡単に DDNS を利用できる．\n取得方法は Google のことなので，仕様変更が多々あると思うので，公式を参考に．</p>\n<h2 id=\"ddclient\">ddclient</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">apt</span> <span class=\"token function\">install</span> ddclient</code></pre></div>\n<p>インストールの際，GUI で色々聞かれますが，後から設定ファイルで設定するので適当に埋めていく．</p>\n<p>設定例は以下．場所は<code class=\"language-text\">/etc/ddclient.conf</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># /etc/ddclient.conf</span>\n<span class=\"token assign-left variable\">daemon</span><span class=\"token operator\">=</span><span class=\"token number\">60</span> <span class=\"token comment\"># サービス化して定期実行する感覚</span>\n\n<span class=\"token assign-left variable\">ssl</span><span class=\"token operator\">=</span>yes\n<span class=\"token assign-left variable\">protocol</span><span class=\"token operator\">=</span>googledomains\n<span class=\"token assign-left variable\">use</span><span class=\"token operator\">=</span>web\n<span class=\"token assign-left variable\">login</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>Google Domainsで取得<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">password</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>Google Domainsで取得<span class=\"token punctuation\">]</span>\nhoge.hoge.com <span class=\"token comment\"># DDNSを設定するドメイン</span></code></pre></div>\n<p>Google Domains で取得する場所はここ．</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4102de885ee3e61bbd0e35e8e1f84e4a/75d3b/ddns.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAuklEQVR42o2Q6W4EIQyD5/0fddvusBy5GPgqmKrHvyJZdkIURz5EFDWjiRC9M+ZkjPHDfzC/ec5JvwYaN4oOxDpHKZVaG+lMSFN6dCI6poab4x5EBL13zGxrVcXNMA9yc86ivCVF/eIwcdoryE/l9VDyu9JSkD9unR5CzYqH34vcEZGtt4E7tg2UMS6OlBIlF1ptm6UJ5/PcWPW66L+vXxeH6J3hctvsvvMs9Y5i/a+e7Rn/wm/9U6/ZTxtWhnykbu/LAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"images\"\n        title=\"\"\n        src=\"/static/4102de885ee3e61bbd0e35e8e1f84e4a/5a190/ddns.png\"\n        srcset=\"/static/4102de885ee3e61bbd0e35e8e1f84e4a/772e8/ddns.png 200w,\n/static/4102de885ee3e61bbd0e35e8e1f84e4a/e17e5/ddns.png 400w,\n/static/4102de885ee3e61bbd0e35e8e1f84e4a/5a190/ddns.png 800w,\n/static/4102de885ee3e61bbd0e35e8e1f84e4a/c1b63/ddns.png 1200w,\n/static/4102de885ee3e61bbd0e35e8e1f84e4a/29007/ddns.png 1600w,\n/static/4102de885ee3e61bbd0e35e8e1f84e4a/75d3b/ddns.png 1966w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>ここから認証情報を取得して設定する．</p>\n<p>さらに，DDNS をサービス化して定期実行する場合は<code class=\"language-text\">/etc/default/ddclient</code>を編集する．</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"># /etc/default/ddclient\n\n<span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span> run_daemon=\"false\"\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> run_daemon=\"true\"\n</span></code></pre></div>\n<p>これであとはサービスに登録すれば OK．</p>\n<p>手動実行する場合は以下を実行する．</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> ddclient <span class=\"token parameter variable\">-daemon</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token parameter variable\">-verbose</span></code></pre></div>\n<h2 id=\"参考\">参考</h2>\n<p><a href=\"https://qiita.com/gorohash/items/8287738ffe47ab52a36f\">https://qiita.com/gorohash/items/8287738ffe47ab52a36f</a>\n<a href=\"https://www.uchidigi.com/2020/01/ddclient-google-ddns.html\">https://www.uchidigi.com/2020/01/ddclient-google-ddns.html</a></p>","tableOfContents":"<ul>\n<li><a href=\"#ddns-%E3%81%A8%E3%81%AF\">DDNS とは</a></li>\n<li><a href=\"#google-domains\">Google Domains</a></li>\n<li><a href=\"#ddclient\">ddclient</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83\">参考</a></li>\n</ul>","excerpt":"今回は，Google Domains の DDNS を使ってドメインに動的に ip アドレスを振る方法を書く． DDNS とは DDNS は Dynamic DNS の略で，ドメインに割り当てられたホストの IP アドレスに変更があった場合に DNS…","frontmatter":{"title":"Google Domainsを使ってDDNSを設定","date":"2021.12.06","update":"2022.02.08","category":"Server","tags":["Server","Linux","Ubuntu","Google Domains"]},"fields":{"slug":"/posts/2021-12-06-googledomains-ddns/"}}},"pageContext":{"id":"ac8bba61-4f37-547a-89ff-3668d2554c21"}},"staticQueryHashes":["1123391092"],"slicesMap":{}}